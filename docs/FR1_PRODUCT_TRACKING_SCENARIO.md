# FR1: íˆ¬ëª… ì •ë³´ ì¶”ì  ìµœì†Œ ë‹¨ìœ„ êµ¬í˜„ ì‹œë‚˜ë¦¬ì˜¤

> TDD Green ë‹¨ê³„ë¥¼ ìœ„í•œ FR1 ìµœì†Œ êµ¬í˜„ ê³„íš

**ì‘ì„±ì¼**: 2025-12-15  
**ëª©í‘œ**: FR1 í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ êµ¬í˜„  
**ë°©ë²•ë¡ **: TDD (Test-Driven Development) - Green ë‹¨ê³„

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œë‚˜ë¦¬ì˜¤ ê°œìš”](#ì‹œë‚˜ë¦¬ì˜¤-ê°œìš”)
2. [í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­ ë¶„ì„](#í…ŒìŠ¤íŠ¸-ìš”êµ¬ì‚¬í•­-ë¶„ì„)
3. [ë°±ì—”ë“œ êµ¬í˜„ ê³„íš](#ë°±ì—”ë“œ-êµ¬í˜„-ê³„íš)
4. [í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê³„íš](#í”„ë¡ íŠ¸ì—”ë“œ-êµ¬í˜„-ê³„íš)
5. [ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™](#ë°ì´í„°ë² ì´ìŠ¤-ì—°ë™)
6. [ìŠ¹ì¸ ìš”ì²­](#ìŠ¹ì¸-ìš”ì²­)

---

## ì‹œë‚˜ë¦¬ì˜¤ ê°œìš”

### ëª©í‘œ

FR1 í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ êµ¬í˜„ì„ ì™„ë£Œí•©ë‹ˆë‹¤.

### ì‚¬ìš©ì ìŠ¤í† ë¦¬

```
Given ê³ ê°ì´ íŠ¹ì • ì›ë‘ ìƒì„¸ í˜ì´ì§€ì— ì ‘ì†í–ˆì„ ë•Œ
When ê³ ê°ì´ 'ì›ë‘ ìŠ¤í† ë¦¬ ì¶”ì ' íƒ­ì„ í´ë¦­í•˜ë©´
Then ìƒì‚°ìì—ê²Œ ëŒì•„ê°„ ìˆ˜ìµ ë¹„ìœ¨ ë° ì›ì‚°ì§€ ë†ì¥ì˜ ìœ„ì¹˜ê°€ ì§€ë„ë¡œ ì‹œê°í™”ë˜ì–´ í‘œì‹œë˜ì–´ì•¼ í•œë‹¤.
```

### êµ¬í˜„ ì›ì¹™

1. **í…ŒìŠ¤íŠ¸ í†µê³¼ ìš°ì„ **: ì‘ì„±ëœ í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼ì‹œí‚¤ëŠ” ìµœì†Œí•œì˜ ì½”ë“œë§Œ êµ¬í˜„
2. **ë°ì´í„°ë² ì´ìŠ¤ í™œìš©**: ì´ë¯¸ ìƒì„±ëœ `tracking` í…Œì´ë¸” ì‚¬ìš©
3. **ìµœì†Œ ê¸°ëŠ¥**: ì§€ë„ëŠ” ê¸°ë³¸ í‘œì‹œë§Œ (ì‹¤ì œ ì§€ë„ API ì—°ë™ì€ í–¥í›„)
4. **ì—ëŸ¬ ì²˜ë¦¬**: 404 ì—ëŸ¬ ì²˜ë¦¬ í¬í•¨

### êµ¬í˜„ ë²”ìœ„

#### âœ… í¬í•¨ ì‚¬í•­
- ë°±ì—”ë“œ API ì—”ë“œí¬ì¸íŠ¸ (`GET /api/products/:id/tracking`)
- ProductTrackingController êµ¬í˜„
- ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¶”ì  ì •ë³´ ì¡°íšŒ
- í”„ë¡ íŠ¸ì—”ë“œ ProductTracking ì»´í¬ë„ŒíŠ¸
- API í˜¸ì¶œ í•¨ìˆ˜ (`productApi.js`)
- ê¸°ë³¸ ì§€ë„ í‘œì‹œ (ì¢Œí‘œ ê¸°ë°˜, ì‹¤ì œ ì§€ë„ APIëŠ” í–¥í›„)
- íƒ­ UI ë° ë°ì´í„° í‘œì‹œ

#### âšª ì œì™¸ ì‚¬í•­ (í–¥í›„ êµ¬í˜„)
- ì‹¤ì œ ì§€ë„ API ì—°ë™ (Google Maps, Naver Maps ë“±)
- ì§€ë„ ë§ˆì»¤ ë° ìƒì„¸ ì •ë³´
- ì¶”ì  ì •ë³´ ìˆ˜ì • ê¸°ëŠ¥
- ë¸”ë¡ì²´ì¸ ê²€ì¦ (FR4)

---

## í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­ ë¶„ì„

### ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­

1. **200 ìƒíƒœ ì½”ë“œ ë°˜í™˜**
   - `GET /api/products/:id/tracking` ì—”ë“œí¬ì¸íŠ¸

2. **ìƒì‚°ì ìˆ˜ìµ ë¹„ìœ¨ ë°˜í™˜**
   - `producerRevenueRatio` ì†ì„±
   - ìˆ«ì íƒ€ì…
   - 0ë³´ë‹¤ í¬ê³  100 ì´í•˜

3. **ë†ì¥ ìœ„ì¹˜ ì •ë³´ ë°˜í™˜**
   - `farmLocation` ê°ì²´
   - `latitude` (ìœ„ë„): -90 ~ 90
   - `longitude` (ê²½ë„): -180 ~ 180
   - `address` (ì£¼ì†Œ)

4. **ì›ì‚°ì§€ ì •ë³´ ë°˜í™˜**
   - `origin` ê°ì²´
   - `country` (êµ­ê°€)
   - `region` (ì§€ì—­)

5. **404 ì—ëŸ¬ ì²˜ë¦¬**
   - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìƒí’ˆ IDì— ëŒ€í•´ 404 ë°˜í™˜

### í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­

1. **íƒ­ ë²„íŠ¼ ë Œë”ë§**
   - 'ì›ë‘ ìŠ¤í† ë¦¬ ì¶”ì ' í…ìŠ¤íŠ¸ í‘œì‹œ

2. **ì¶”ì  ì •ë³´ í‘œì‹œ**
   - íƒ­ í´ë¦­ ì‹œ ì¶”ì  ì •ë³´ í‘œì‹œ
   - 'ìƒì‚°ì ìˆ˜ìµ ë¹„ìœ¨' í…ìŠ¤íŠ¸ í¬í•¨
   - ìˆ˜ìµ ë¹„ìœ¨ í¼ì„¼íŠ¸ í‘œì‹œ (ì˜ˆ: "45.5%")

3. **ì§€ë„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§**
   - `data-testid="farm-map"` ì†ì„± ê°€ì§„ ìš”ì†Œ
   - ë†ì¥ ìœ„ì¹˜ ì¢Œí‘œ í‘œì‹œ

4. **ë†ì¥ ìœ„ì¹˜ ì£¼ì†Œ í‘œì‹œ**
   - ì£¼ì†Œ í…ìŠ¤íŠ¸ í‘œì‹œ

5. **ì›ì‚°ì§€ ì •ë³´ í‘œì‹œ**
   - êµ­ê°€ ë° ì§€ì—­ í‘œì‹œ

---

## ë°±ì—”ë“œ êµ¬í˜„ ê³„íš

### 1. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
backend/src/
â”œâ”€â”€ modules/
â”‚   â””â”€â”€ tracking/
â”‚       â”œâ”€â”€ productTrackingController.js  # ì»¨íŠ¸ë¡¤ëŸ¬ (ì‹ ê·œ)
â”‚       â”œâ”€â”€ productTrackingService.js     # ì„œë¹„ìŠ¤ (ì‹ ê·œ)
â”‚       â””â”€â”€ productTrackingRoutes.js      # ë¼ìš°íŠ¸ (ì‹ ê·œ)
â”œâ”€â”€ models/
â”‚   â””â”€â”€ Tracking.js                       # Tracking ëª¨ë¸ (ì‹ ê·œ)
â””â”€â”€ routes/
    â””â”€â”€ index.js                          # ë¼ìš°íŠ¸ í†µí•© (ì—…ë°ì´íŠ¸)
```

### 2. êµ¬í˜„ íŒŒì¼ ìƒì„¸

#### 2.1 Tracking ëª¨ë¸ (`models/Tracking.js`)

**ê¸°ëŠ¥**:
- ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¶”ì  ì •ë³´ ì¡°íšŒ
- ìƒí’ˆ IDë¡œ ì¶”ì  ì •ë³´ ê²€ìƒ‰

**ë©”ì„œë“œ**:
```javascript
- findByProductId(productId)
```

#### 2.2 ProductTrackingService (`modules/tracking/productTrackingService.js`)

**ê¸°ëŠ¥**:
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- ë°ì´í„° ë³€í™˜ ë° í¬ë§·íŒ…

**í•¨ìˆ˜**:
```javascript
- getProductTracking(productId)
```

#### 2.3 ProductTrackingController (`modules/tracking/productTrackingController.js`)

**ê¸°ëŠ¥**:
- HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- ì—ëŸ¬ ì²˜ë¦¬

**ì—”ë“œí¬ì¸íŠ¸ í•¸ë“¤ëŸ¬**:
```javascript
- getTracking(req, res, next)
```

#### 2.4 ProductTrackingRoutes (`modules/tracking/productTrackingRoutes.js`)

**ë¼ìš°íŠ¸ ì •ì˜**:
```javascript
GET /api/products/:id/tracking
```

### 3. API ì‘ë‹µ í˜•ì‹

**ì„±ê³µ ì‘ë‹µ** (200 OK):
```json
{
  "success": true,
  "producerRevenueRatio": 45.5,
  "farmLocation": {
    "latitude": 8.9806,
    "longitude": 38.7578,
    "address": "ì˜ˆê°€ì²´í”„, ì‹œë‹¤ë§ˆ ì£¼, ì—í‹°ì˜¤í”¼ì•„"
  },
  "origin": {
    "country": "ì—í‹°ì˜¤í”¼ì•„",
    "region": "ì˜ˆê°€ì²´í”„"
  }
}
```

**ì—ëŸ¬ ì‘ë‹µ** (404 Not Found):
```json
{
  "success": false,
  "message": "ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
  "error": "PRODUCT_NOT_FOUND"
}
```

---

## í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê³„íš

### 1. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
frontend/src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ Product/
â”‚       â””â”€â”€ ProductTracking.jsx          # ì»´í¬ë„ŒíŠ¸ (ê°œì„ )
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ productApi.js                # API í´ë¼ì´ì–¸íŠ¸ (ê°œì„ )
â””â”€â”€ components/
    â””â”€â”€ tracking/
        â””â”€â”€ FarmMap.jsx                  # ì§€ë„ ì»´í¬ë„ŒíŠ¸ (ì‹ ê·œ)
```

### 2. êµ¬í˜„ íŒŒì¼ ìƒì„¸

#### 2.1 ProductTracking ì»´í¬ë„ŒíŠ¸ (`pages/Product/ProductTracking.jsx`)

**ê¸°ëŠ¥**:
- íƒ­ UI êµ¬í˜„
- ì¶”ì  ì •ë³´ í‘œì‹œ
- ë¡œë”© ë° ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬

**UI ìš”ì†Œ**:
- 'ì›ë‘ ìŠ¤í† ë¦¬ ì¶”ì ' íƒ­ ë²„íŠ¼
- ìƒì‚°ì ìˆ˜ìµ ë¹„ìœ¨ í‘œì‹œ
- ë†ì¥ ìœ„ì¹˜ ì •ë³´ í‘œì‹œ
- ì›ì‚°ì§€ ì •ë³´ í‘œì‹œ
- ì§€ë„ ì»´í¬ë„ŒíŠ¸

**ìƒíƒœ ê´€ë¦¬**:
```javascript
- isLoading: boolean
- trackingData: object | null
- error: string | null
- activeTab: string
```

#### 2.2 FarmMap ì»´í¬ë„ŒíŠ¸ (`components/tracking/FarmMap.jsx`)

**ê¸°ëŠ¥**:
- ë†ì¥ ìœ„ì¹˜ ì¢Œí‘œ í‘œì‹œ
- ê¸°ë³¸ ì§€ë„ ì‹œê°í™” (í…ìŠ¤íŠ¸ ê¸°ë°˜ ë˜ëŠ” ê°„ë‹¨í•œ SVG)

**Props**:
```javascript
{
  latitude: number,
  longitude: number,
  address: string
}
```

**êµ¬í˜„ ë°©ì‹**:
- MVPì—ì„œëŠ” ì‹¤ì œ ì§€ë„ API ì—†ì´ ì¢Œí‘œì™€ ì£¼ì†Œë¥¼ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œ
- `data-testid="farm-map"` ì†ì„± í¬í•¨
- í–¥í›„ Google Maps ë˜ëŠ” Naver Maps ì—°ë™ ê°€ëŠ¥í•˜ë„ë¡ êµ¬ì¡° ì„¤ê³„

#### 2.3 productApi (`services/api/productApi.js`)

**ê¸°ëŠ¥**:
- ë°±ì—”ë“œ API í˜¸ì¶œ
- ì—ëŸ¬ ì²˜ë¦¬

**í•¨ìˆ˜**:
```javascript
- getProductTracking(productId)
```

---

## ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™

### ì‚¬ìš©í•  í…Œì´ë¸”

**tracking í…Œì´ë¸”** (ì´ë¯¸ ìƒì„±ë¨):
```sql
- id
- product_id (FK -> products.id)
- producer_revenue_ratio
- farm_latitude
- farm_longitude
- farm_address
- origin_country
- origin_region
```

### ì¿¼ë¦¬ ì˜ˆì‹œ

```sql
-- ìƒí’ˆ IDë¡œ ì¶”ì  ì •ë³´ ì¡°íšŒ
SELECT 
  producer_revenue_ratio,
  farm_latitude,
  farm_longitude,
  farm_address,
  origin_country,
  origin_region
FROM tracking
WHERE product_id = $1;
```

---

## êµ¬í˜„ íŒŒì¼ ëª©ë¡

### ë°±ì—”ë“œ íŒŒì¼ (4ê°œ)

1. `backend/src/models/Tracking.js` - Tracking ëª¨ë¸ (ì‹ ê·œ)
2. `backend/src/modules/tracking/productTrackingService.js` - ì¶”ì  ì„œë¹„ìŠ¤ (ì‹ ê·œ)
3. `backend/src/modules/tracking/productTrackingController.js` - ì¶”ì  ì»¨íŠ¸ë¡¤ëŸ¬ (ì‹ ê·œ)
4. `backend/src/modules/tracking/productTrackingRoutes.js` - ì¶”ì  ë¼ìš°íŠ¸ (ì‹ ê·œ)
5. `backend/src/routes/index.js` - ë¼ìš°íŠ¸ í†µí•© (ì—…ë°ì´íŠ¸)

### í”„ë¡ íŠ¸ì—”ë“œ íŒŒì¼ (3ê°œ)

1. `frontend/src/pages/Product/ProductTracking.jsx` - ì¶”ì  ì»´í¬ë„ŒíŠ¸ (ê°œì„ )
2. `frontend/src/components/tracking/FarmMap.jsx` - ì§€ë„ ì»´í¬ë„ŒíŠ¸ (ì‹ ê·œ)
3. `frontend/src/services/api/productApi.js` - API í´ë¼ì´ì–¸íŠ¸ (ê°œì„ )

---

## ì˜ˆìƒ ê²°ê³¼

### ìƒì„±ë  íŒŒì¼
- **ë°±ì—”ë“œ**: 5ê°œ íŒŒì¼ (ì‹ ê·œ 4ê°œ, ì—…ë°ì´íŠ¸ 1ê°œ)
- **í”„ë¡ íŠ¸ì—”ë“œ**: 3ê°œ íŒŒì¼ (ì‹ ê·œ 1ê°œ, ê°œì„  2ê°œ)
- **ì´ 8ê°œ íŒŒì¼**

### ê¸°ëŠ¥
- âœ… ìƒí’ˆ ì¶”ì  ì •ë³´ ì¡°íšŒ API
- âœ… ìƒì‚°ì ìˆ˜ìµ ë¹„ìœ¨ í‘œì‹œ
- âœ… ë†ì¥ ìœ„ì¹˜ ì •ë³´ í‘œì‹œ (ì¢Œí‘œ ë° ì£¼ì†Œ)
- âœ… ì›ì‚°ì§€ ì •ë³´ í‘œì‹œ
- âœ… ì§€ë„ ì»´í¬ë„ŒíŠ¸ (ê¸°ë³¸ í‘œì‹œ)
- âœ… íƒ­ UI
- âœ… ë¡œë”© ë° ì—ëŸ¬ ì²˜ë¦¬

---

## ìŠ¹ì¸ ìš”ì²­

### êµ¬í˜„ ê³„íš ìš”ì•½

1. **ë°±ì—”ë“œ êµ¬í˜„** (5ê°œ íŒŒì¼)
   - Tracking ëª¨ë¸ ìƒì„±
   - ProductTrackingService êµ¬í˜„
   - ProductTrackingController êµ¬í˜„
   - ProductTrackingRoutes ìƒì„±
   - ë¼ìš°íŠ¸ í†µí•© íŒŒì¼ ì—…ë°ì´íŠ¸

2. **í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„** (3ê°œ íŒŒì¼)
   - ProductTracking ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
   - FarmMap ì»´í¬ë„ŒíŠ¸ ìƒì„± (ê¸°ë³¸ ì§€ë„ í‘œì‹œ)
   - productApi í•¨ìˆ˜ êµ¬í˜„

3. **í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸**
   - ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ 5ê°œ ì¼€ì´ìŠ¤ í†µê³¼
   - í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ 5ê°œ ì¼€ì´ìŠ¤ í†µê³¼

### ì˜ˆìƒ ì†Œìš” ì‹œê°„

- ë°±ì—”ë“œ êµ¬í˜„: 2-3ì‹œê°„
- í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„: 2-3ì‹œê°„
- í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…: 1ì‹œê°„
- **ì´ 5-7ì‹œê°„** (1ì¼)

### ìŠ¹ì¸ ì—¬ë¶€

ë‹¤ìŒ ì‘ì—…ì„ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

- [ ] âœ… **ìŠ¹ì¸** - FR1 íˆ¬ëª… ì •ë³´ ì¶”ì  êµ¬í˜„ ì‹œì‘
- [ ] â¸ï¸ **ë³´ë¥˜** - ì¶”ê°€ ê²€í†  í•„ìš”
- [ ] âœï¸ **ìˆ˜ì • ìš”ì²­** - ì‹œë‚˜ë¦¬ì˜¤ ë³€ê²½ í•„ìš”

**ìŠ¹ì¸ ì‹œ ì§„í–‰í•  ì‘ì—…**:
1. ë°±ì—”ë“œ Tracking ëª¨ë¸ ë° ì„œë¹„ìŠ¤/ì»¨íŠ¸ë¡¤ëŸ¬/ë¼ìš°íŠ¸ êµ¬í˜„
2. í”„ë¡ íŠ¸ì—”ë“œ ProductTracking ì»´í¬ë„ŒíŠ¸ ë° FarmMap ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
3. productApi í•¨ìˆ˜ êµ¬í˜„
4. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° í†µê³¼ í™•ì¸

---

**ì‘ì„±ì¼**: 2025-12-15  
**ìŠ¹ì¸ ëŒ€ê¸° ì¤‘**

